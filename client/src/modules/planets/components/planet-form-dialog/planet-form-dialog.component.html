<h2 mat-dialog-title>{{ mode === 'create' ? 'New planet' : 'Edit planet' }}</h2>

<mat-dialog-content class="dialog-content">
    <form [formGroup]="form" class="planet-form">

        <!-- Photo -->
        <div class="form-group">
            <label class="field-label">Photo</label>
            <div class="photo-input">
                <input type="file" accept="image/*" (change)="onFileChange($event)" />
                @if (previewUrl$ | async; as preview) {
                    <div class="preview">
                        <img [src]="preview" alt="preview" />
                        <button mat-stroked-button color="warn" type="button" (click)="removeImage()">Remove</button>
                    </div>
                }
                
            </div>
        </div>

        <!-- Name -->
        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Name</mat-label>
            <input matInput formControlName="planetName" />
            @if (form.get('planetName')?.hasError('required')) {
                <mat-error>Name is required</mat-error>
            }
        </mat-form-field>

        <!-- Description -->
        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Description</mat-label>
            <textarea matInput rows="4" formControlName="description"></textarea>
        </mat-form-field>

        <!-- Row: Radius & Color -->
        <div class="row">
            <mat-form-field appearance="outline" class="half-width">
                <mat-label>Radius in km</mat-label>
                <input matInput type="number" formControlName="planetRadiusKM" />
                @if (form.get('planetRadiusKM')?.hasError('required')) {
                    <mat-error>Planet radius is required</mat-error>
                }
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width">
                <mat-label>Color</mat-label>
                <input matInput formControlName="planetColor" />
                @if (form.get('planetColor')?.hasError('required')) {
                    <mat-error>Planet color is required</mat-error>
                }
            </mat-form-field>
        </div>

        <!-- Row: Distances -->
        <div class="row">
            <mat-form-field appearance="outline" class="half-width">
                <mat-label>Dist. from Sun (M km)</mat-label>
                <input matInput type="number" formControlName="distFromSun" />
                @if (form.get('distFromSun')?.hasError('required')) {
                    <mat-error>Planet distance from sun is required</mat-error>
                }
            </mat-form-field>

            <mat-form-field appearance="outline" class="half-width">
                <mat-label>Dist. from Earth (M km)</mat-label>
                <input matInput type="number" formControlName="distFromEarth" />
                @if (form.get('distFromEarth')?.hasError('required')) {
                    <mat-error>Planet distance from Earth is required</mat-error>
                }
            </mat-form-field>
        </div>
    </form>
</mat-dialog-content>

<mat-dialog-actions align="end" class="actions">
    <button mat-stroked-button type="button" (click)="cancel()">Cancel</button>
    <button mat-flat-button color="primary" (click)="submit()" [disabled]="form.invalid || isSubmitting">
        {{ mode === 'create' ? 'Create' : 'Update' }}
    </button>
</mat-dialog-actions>